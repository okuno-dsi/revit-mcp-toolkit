{"meta": "revitmcp_commands_core", "version": "2025-10-08", "notes": "Core, high-impact commands for AI agents. Units: inputs in mm/deg unless stated; Revit internal=ft/rad.", "fields": ["method", "category", "importance", "kind", "summary", "params_example", "result_example", "units", "errors"]}
{"method": "ping_server", "category": "Bootstrap/Project", "importance": "normal", "kind": "write", "summary": "Health check for MCP server ↔ Revit add-in round trip. Returns ok/message and light metadata.", "params_example": {}, "result_example": {"ok": true, "msg": "MCP Server round-trip OK", "product": "Autodesk Revit 2024"}}
{"method": "get_project_info", "category": "Bootstrap/Project", "importance": "high", "kind": "read", "summary": "Retrieve Project Information element fields (name, number, client, address, etc.).", "params_example": {}, "result_example": {"ok": true, "projectName": "Sample Building", "projectNumber": "P-2025-01"}}
{"method": "get_open_documents", "category": "Bootstrap/Project", "importance": "normal", "kind": "read", "summary": "List open documents with link topology and worksharing flags.", "params_example": {}, "result_example": {"ok": true, "count": 2, "documents": [{"title": "Host.rvt", "isWorkshared": true, "linkCount": 1}]}}
{"method": "get_current_view", "category": "Views/Graphics", "importance": "normal", "kind": "read", "summary": "Return the currently active view id.", "params_example": {}, "result_example": {"ok": true, "viewId": 401}}
{"method": "get_elements_in_view", "category": "Views/Graphics", "importance": "high", "kind": "read", "summary": "Return visible element ids for the specified (or active) view.", "params_example": {"viewId": 401}, "result_example": {"ok": true, "totalCount": 3, "elementIds": [1, 2, 3]}}
{"method": "get_element_info", "category": "ElementOps", "importance": "high", "kind": "read", "summary": "Get element basics (category, family/type, level, coordinates). Use rich=true for extended fields.", "params_example": {"elementIds": [1, 2], "rich": true}, "result_example": {"ok": true, "count": 2, "elements": [{"elementId": 1, "category": "Wall", "typeName": "Generic - 200mm"}]}}
{"method": "get_walls", "category": "Walls", "importance": "normal", "kind": "read", "summary": "List wall instances (paged). Returns walls[] + wallsById{}; doubles in mm.", "params_example": {"skip": 0, "count": 50}, "result_example": {"ok": true, "totalCount": 2, "walls": [{"elementId": 101, "typeName": "Generic - 150mm"}]}}
{"method": "get_wall_types", "category": "Walls", "importance": "normal", "kind": "read", "summary": "List WallType definitions; includes width (mm).", "params_example": {"skip": 0, "count": 20}, "result_example": {"ok": true, "totalCount": 2, "types": [{"typeId": 201, "typeName": "Generic - 150mm", "width": 150.0}]}}
{"method": "create_wall", "category": "Walls", "importance": "normal", "kind": "write", "summary": "Create a wall from start/end (mm). heightMm supports numeric or 'level-to-level'. Base level required.", "params_example": {"start": {"x": 0, "y": 0, "z": 0}, "end": {"x": 6000, "y": 0, "z": 0}, "baseLevelName": "1FL", "wallTypeName": "Basic Wall 150", "heightMm": "level-to-level"}, "result_example": {"ok": true, "elementId": 124, "mode": "top-constrained"}, "units": {"input": {"Length": "mm"}, "output": {"Length": "mm"}}, "errors": [{"code": "NOT_FOUND_LEVEL"}, {"code": "NOT_FOUND_WALLTYPE"}]}
{"method": "update_wall_parameter", "category": "Walls", "importance": "high", "kind": "write", "summary": "Set a wall instance parameter by name. Double expects mm; element id/name accepted.", "params_example": {"elementId": 123, "paramName": "Unconnected Height", "value": 3500.0}, "result_example": {"ok": true}}
{"method": "change_wall_type", "category": "Walls", "importance": "high", "kind": "write", "summary": "Change a wall’s type (Element.ChangeTypeId).", "params_example": {"elementId": 123, "typeId": 202}, "result_example": {"ok": true, "elementId": 123, "oldTypeId": 201, "newTypeId": 202}}
{"method": "get_wall_layers", "category": "Walls", "importance": "high", "kind": "read", "summary": "Return Compound Structure layers (outside→inside) with materials and thicknessMm; includes core bounds.", "params_example": {"typeId": 201}, "result_example": {"ok": true, "layers": [{"index": 2, "function": "Structure", "materialName": "Concrete", "thicknessMm": 120.0}], "totalThicknessMm": 150.0}}
{"method": "create_floor", "category": "Floors", "importance": "high", "kind": "write", "summary": "Create a floor from boundary loops (mm) on a level.", "params_example": {"levelId": 101, "floorTypeId": 301, "boundary": [{"points": [{"x": 0, "y": 0, "z": 0}, {"x": 4000, "y": 0, "z": 0}, {"x": 4000, "y": 2000, "z": 0}, {"x": 0, "y": 2000, "z": 0}]}]}, "result_example": {"ok": true, "elementId": 555, "levelId": 101, "typeId": 301}}
{"method": "get_floor_types", "category": "Floors", "importance": "normal", "kind": "read", "summary": "List Floor types with filters/paging; doubles in mm.", "params_example": {"skip": 0, "count": 100, "nameContains": "Concrete"}, "result_example": {"ok": true, "totalCount": 12, "floorTypes": [{"typeId": 1102, "typeName": "200mm Concrete"}]}}
{"method": "get_floor_layers", "category": "Floors", "importance": "high", "kind": "read", "summary": "List Compound Structure layers of a Basic Floor; returns totalThicknessMm and core boundaries.", "params_example": {"typeId": 1102}, "result_example": {"ok": true, "layers": [{"index": 1, "function": "Structure", "materialName": "Concrete", "thicknessMm": 194.0}], "totalThicknessMm": 200.0}}
{"method": "update_floor_boundary", "category": "Floors", "importance": "high", "kind": "write", "summary": "Replace a floor’s boundary with new loops (mm).", "params_example": {"elementId": 555, "boundary": [{"points": [{"x": 0, "y": 0, "z": 0}, {"x": 5000, "y": 0, "z": 0}, {"x": 5000, "y": 2500, "z": 0}, {"x": 0, "y": 2500, "z": 0}]}]}, "result_example": {"ok": true}}
{"method": "create_grids", "category": "Levels/Grids", "importance": "high", "kind": "write", "summary": "Create grids by axis+positions or explicit segments (mm).", "params_example": {"axis": "Y", "positions": [0, 8000, 16000], "defaultLengthMm": 30000, "names": ["Y1", "Y2", "Y3"]}, "result_example": {"ok": true, "gridIds": [201, 202, 203]}}
{"method": "get_levels", "category": "Levels/Grids", "importance": "high", "kind": "read", "summary": "List levels; supports paging and meta-only when count=0.", "params_example": {"skip": 0, "count": 10}, "result_example": {"ok": true, "totalCount": 2, "levels": [{"levelId": 201, "name": "1FL", "elevation": 0.0}]}}
{"method": "create_room", "category": "Rooms/Spaces", "importance": "high", "kind": "write", "summary": "Create a Room at (x,y) mm on a level (levelId or levelName). Defaults: autoTag=true, strictEnclosure=true; returns {ok, mode:created|existing, elementId, name, tagId?, location{xMm,yMm}, units}.", "params_example": {"levelName": "1FL", "x": 4000.0, "y": 2000.0, "autoTag": true, "strictEnclosure": true}, "result_example": {"ok": true, "mode": "created", "elementId": 1001, "name": "Room 1", "tagId": 777, "location": {"xMm": 4000.0, "yMm": 2000.0}, "units": {"Length": "mm"}}}
{"method": "get_rooms", "category": "Rooms/Spaces", "importance": "high", "kind": "read", "summary": "List rooms (paged). Returns rooms[] + roomsById{} with area (m²) and center (mm).", "params_example": {"skip": 0, "count": 10}, "result_example": {"ok": true, "totalCount": 5, "rooms": [{"elementId": 60455799, "name": "園芸", "area": 49.0}]}}
{"method": "set_visual_override", "category": "Views/Graphics", "importance": "high", "kind": "write", "summary": "Apply fill color/transparency overrides to elements in a view. Skips safely if a View Template locks overrides.", "params_example": {"viewId": 401, "elementIds": [1, 2, 3], "r": 255, "g": 0, "b": 0, "transparency": 40}, "result_example": {"ok": true, "viewId": 401, "count": 3, "templateApplied": false}}
{"method": "reset_all_view_overrides", "category": "Views/Graphics", "importance": "high", "kind": "write", "summary": "Clear all graphic overrides (categories & elements) in a view; also handles temporary hide/isolate if possible.", "params_example": {"viewId": 256}, "result_example": {"ok": true, "viewId": 256, "clearedCategories": 100, "clearedElements": 200}}
{"method": "export_dwg", "category": "ExportOps", "importance": "normal", "kind": "write", "summary": "Export visible elements of a view to DWG (As Displayed). Supports batch via items[] with startIndex/batchSize/maxMillisPerTx and explicit Export Setup.", "params_example": {"items": [{"viewId": 401, "outputFolder": "C:\\Exports", "fileName": "Plan_1F"}, {"viewId": 402, "outputFolder": "C:\\Exports", "fileName": "Plan_2F"}], "dwgVersion": "ACAD2018", "useExportSetup": "JIS-A-ByLayer-2024", "startIndex": 0, "batchSize": 5}, "result_example": {"ok": true, "processed": 2, "completed": true}}
{"method": "set_section_box_by_elements", "category": "Views/Graphics", "importance": "normal", "kind": "write", "summary": "Enable/update a 3D view’s section box to fit specified element IDs with optional padding (mm).", "params_example": {"viewId": 401, "elementIds": [123, 456, 789], "paddingMm": 100}, "result_example": {"ok": true, "viewId": 401, "sectionBox": {"min": {"x": -500.0, "y": -1200.0, "z": 0.0}, "max": {"x": 3500.0, "y": 2200.0, "z": 3000.0}}}}
