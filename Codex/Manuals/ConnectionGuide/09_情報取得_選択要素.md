# Revit 選択要素の情報取得手順

## 1. 目的
Revitのビュー上でユーザーが選択している一つまたは複数の要素について、基本的な情報（要素ID, カテゴリ, ファミリ名, タイプ名）をまとめて取得します。

## 2. 概要
この操作は、通常2つのコマンドを連続して実行することで実現します。
1.  `get_selected_element_ids`: 現在選択されている要素のIDリストを取得します。
2.  `get_element_info`: ステップ1で取得したIDリストを使い、各要素の基本情報を一括で取得します。

## 3. 実行手順

### ステップ1: 選択要素のIDを取得
まず、Revit上で情報を取得したい要素を選択した状態で、以下のコマンドを実行し、選択要素のIDリストを取得します。

**実行コマンド:**
```bash
python Python/Manuals/Scripts/send_revit_command_durable.py --port 5210 --command get_selected_element_ids
```

**実行結果例:**
```json
{
  "ok": true,
  "elementIds": [279657, 279659]
}
```
この `elementIds` のリストを次のステップで使用します。

### ステップ2: 要素の詳細情報を取得
次に、ステップ1で取得したIDリストをパラメータとして、`get_element_info` コマンドを実行します。

**実行コマンド:**
```bash
python Python/Manuals/Scripts/send_revit_command_durable.py --port 5210 --command get_element_info --params "{\"elementIds\": [279657, 279659]}"
```

## 4. 最終的な実行結果
コマンドが正常に実行されると、コンソールに以下のようなJSON形式のテキストが出力されます。`elements` 配列の中に、選択された各要素の基本情報が格納されます。

**実行結果例:**
```json
{
  "ok": true,
  "count": 2,
  "elements": [
    {
      "elementId": 279657,
      "category": "壁",
      "familyName": "カーテンウォール",
      "typeName": "カーテンウォール"
    },
    {
      "elementId": 279659,
      "category": "壁",
      "familyName": "カーテンウォール",
      "typeName": "カーテンウォール"
    }
  ]
}
```

## 5. 注意事項
-   `get_element_info` コマンドで取得できるのは、カテゴリ、ファミリ、タイプといった基本的な情報です。座標やレベル、その他の詳細なパラメータを取得するには、`get_bounding_box` や各カテゴリ専用のパラメータ取得コマンド（例: `get_wall_parameters`）を別途実行する必要があります。

