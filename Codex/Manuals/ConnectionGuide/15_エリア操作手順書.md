# 手順書15: エリアの作成と管理

## 1. 概要
このドキュメントは、Revitでエリアプランを作成し、エリア境界を設定、エリアを配置して名前を付けるまでの一連の操作をまとめたものです。

## 2. エリアプランの作成

まず、エリアを配置するための専用ビューである「エリアプラン」を作成します。
ユーザーによるエリアスキームの指定がない場合は、`get_area_schemes` コマンドで利用可能なエリアスキームの取得を行って、どれを選択するのか確認してからでないと先に進んではいけません

### 手順
1.  **エリアスキームの取得:**
    `get_area_schemes` コマンドで、利用可能なエリアスキーム（例：「床面積」）のIDを取得します。
    ```bash
    python Python/Manuals/Scripts/send_revit_command_durable.py --port 5210 --command get_area_schemes
    ```

2.  **レベルの取得:**
    `get_levels` コマンドで、エリアプランを作成したいレベル（例：「1FL」）のIDを取得します。
    ```bash
    python Python/Manuals/Scripts/send_revit_command_durable.py --port 5210 --command get_levels
    ```

3.  **エリアプランの作成:**
    取得したレベルIDとエリアスキームIDを使い、`create_area_plan` コマンドでエリアプランビューを作成します。
    ```bash
    python Python/Manuals/Scripts/send_revit_command_durable.py --port 5210 --command create_area_plan --params "{\"levelId\": 49173, \"areaSchemeId\": 59883165, \"name\": \"1FL Area Plan\"}"
    ```

## 3. エリア境界の作成

エリアプラン上に、エリアの範囲を定義する境界線を作成します。作成には2つの方法があります。

### 3.1. 方法A: 壁から自動作成
ビュー内の壁をトレースして、エリア境界を自動生成します。

- **コマンド:** `auto_area_boundaries_from_walls`
- **実行例:**
  ```bash
  python Python/Manuals/Scripts/send_revit_command_durable.py --port 5210 --command auto_area_boundaries_from_walls --params "{\"viewId\": 60529907}"
  ```
  *`viewId`には、ステップ2で作成したエリアプランのIDを指定します。*

### 3.2. 方法B: 部屋の境界からコピー
既存の部屋の境界線を流用して、エリア境界を作成します。

#### 手順
1.  **部屋IDの取得:**
    `get_rooms` コマンドで、対象レベルの部屋IDリストを取得します。
    ```bash
    python Python/Manuals/Scripts/send_revit_command_durable.py --port 5210 --command get_rooms --params "{\"levelId\": 49173}"
    ```

2.  **境界のコピー:**
    `copy_area_boundaries_from_rooms` コマンドで、取得した部屋IDとエリアプランのビューIDを指定して境界をコピーします。
    ```bash
    python Python/Manuals/Scripts/send_revit_command_durable.py --port 5210 --command copy_area_boundaries_from_rooms --params "{\"viewId\": 60529907, \"roomIds\": [60522362, 60528905]}"
    ```

## 4. エリアの配置と名前の変更

境界で囲まれたスペースに、エリア要素を配置し、名前を設定します。

### 手順
1.  **エリアの作成:**
    `create_area` コマンドで、エリアを配置したい位置（部屋の重心など）の座標とレベルIDを指定してエリアを作成します。
    ```bash
    python Python/Manuals/Scripts/send_revit_command_durable.py --port 5210 --command create_area --params "{\"levelId\": 49173, \"x\": 8563.774, \"y\": 9546.32}"
    ```
    *このコマンドは、作成された新しいエリアの `areaId` を返します。*

2.  **エリア名の更新:**
    `update_area` コマンドで、作成されたエリアの `areaId` と、設定したい名前（`paramName`: "名前"）を指定して、名前を更新します。
    ```bash
    python Python/Manuals/Scripts/send_revit_command_durable.py --port 5210 --command update_area --params "{\"areaId\": 60529952, \"paramName\": \"名前\", \"value\": \"前室\"}"
    ```

*この手順を部屋の数だけ繰り返すことで、すべての部屋に対応するエリアを作成・命名できます。

