# Revit要素のタイプ変更手順書

## 1. 目的

この手順書は、Revitモデル内の特定の要素（例: 構造柱、壁など）のタイプを、別の既存のタイプに変更するプロセスを説明します。

**【重要: IDの取り扱いについて】**
Revit要素の識別には、`Element ID`（整数値）と`Unique ID`（GUID文字列）の2種類があります。`Unique ID`はプロジェクト間で一意であり、より堅牢な識別子として推奨されます。可能な限り`Unique ID`の使用を優先してください。

## 2. 関連コマンド

### 2.1. 情報取得コマンド

タイプ変更を行う前に、変更対象の「要素のID」と、変更先の「タイプのID」を特定する必要があります。

1.  **要素のIDを特定**: `get_structural_columns`, `get_walls` など、カテゴリに応じた一覧取得コマンドを実行し、変更したい要素の `elementId` または `uniqueId` を控えます。
2.  **タイプのIDを特定**: `get_structural_column_types`, `get_wall_types` など、カテゴリに応じたタイプ一覧取得コマンドを実行し、変更先としたいタイプの `typeId` または `uniqueId` を控えます。

### 2.2. タイプ変更コマンド

Revitアドインには、カテゴリごとにタイプ変更用のコマンドが用意されています。

-   `change_structural_column_type`: 構造柱のタイプを変更します。
-   `change_structural_frame_type`: 構造フレームのタイプを変更します。
-   `change_wall_type`: 壁のタイプを変更します。
-   など、他のカテゴリにも同様のコマンドが存在する場合があります。

**パラメータ:**
-   `elementId` (integer): タイプを変更する要素のElementId。
-   `typeId` (integer): 新しく設定するタイプのElementId。
-   (推奨) `uniqueId` (string): `elementId`の代わりに使用できます。
-   (推奨) `typeUniqueId` (string): `typeId`の代わりに使用できます。

**実行例（構造柱のタイプを変更する場合）:**
`elementId`が`901`の構造柱を、`typeId`が`802`のタイプに変更します。

```bash
python Python/Scripts/Reference/send_revit_command_durable.py --port 5211 --command change_structural_column_type --params "{"elementId": 901, "typeId": 802}"
```

**Unique IDを使用する場合（推奨）:**
```bash
python Python/Scripts/Reference/send_revit_command_durable.py --port 5211 --command change_structural_column_type --params "{"uniqueId": "element-unique-id-string", "typeUniqueId": "type-unique-id-string"}"
```

## 3. 実行結果

コマンドが正常に実行されると、成功を示すJSONが返され、Revitモデル内の要素のタイプが更新されます。

```json
{
  "ok": true,
  "newTypeId": 802
}
```

## 4. 注意事項

-   **互換性のないタイプ**: 要素に対して互換性のないタイプIDを指定した場合（例: 壁要素に柱のタイプIDを指定）、コマンドはエラーになります。
-   **IDの正確性**: 存在しないIDを指定するとエラーになります。事前に情報取得コマンドで正しいIDを確認してください。




