# Revit要素タイプの複製と名前変更手順書

## 1. 目的

この手順書は、Revitモデル内の既存の要素タイプ（例: 構造柱タイプ）を複製し、新しい名前を付ける方法を説明します。

**【重要: IDの取り扱いについて】**
Revit要素の識別には、`Element ID`（整数値）と`Unique ID`（GUID文字列）の2種類があります。`Unique ID`はプロジェクト間で一意であり、より堅牢な識別子として推奨されます。可能な限り`Unique ID`の使用を優先してください。

## 2. 関連コマンド

### 2.1. タイプ一覧取得コマンド

まず、複製したいタイプのIDを特定するために、対象カテゴリのタイプ一覧を取得します。

-   `get_structural_column_types`: 構造柱の全タイプを取得します。
-   `get_structural_frame_types`: 構造フレームの全タイプを取得します。
-   `get_wall_types`: 壁の全タイプを取得します。
-   など、各カテゴリに対応したコマンドを使用します。

**実行例（構造柱タイプの場合）:**
```bash
python Python/Scripts/Reference/send_revit_command_durable.py --port 5211 --command get_structural_column_types
```
このコマンドの実行結果から、複製したいタイプの `typeId` または `uniqueId` を控えておきます。

### 2.2. タイプ複製コマンド

次に、控えたIDを使用してタイプを複製します。

-   `duplicate_structural_column_type`: 構造柱タイプを複製します。
-   `duplicate_structural_frame_type`: 構造フレームタイプを複製します。
-   `duplicate_wall_type`: 壁タイプを複製します。
-   など、各カテゴリに対応したコマンドを使用します。

**パラメータ:**
-   `typeId` (integer): 複製元のタイプのElementId。
-   `newName` (string): 作成される新しいタイプの名前。
-   (推奨) `typeUniqueId` (string): `typeId`の代わりに、複製元のタイプのUniqueIdを指定することも可能です。

**実行例（構造柱タイプの場合）:**
ID `801` のタイプを「H-400x400 Copy」という名前で複製します。

```bash
python Python/Scripts/Reference/send_revit_command_durable.py --port 5211 --command duplicate_structural_column_type --params "{\"typeId\": 801, \"newName\": \"H-400x400 Copy\"}"
```

**実行結果:**
成功すると、新しく作成されたタイプのID（`newTypeId`）とUniqueId（`newTypeUniqueId`）を含むJSONが返されます。

```json
{
  "ok": true,
  "newTypeId": 803,
  "newTypeUniqueId": "some-new-unique-id"
}
```

## 3. 注意事項

-   **文字化け対策**: `Scripts/Reference/send_revit_command_durable.py` スクリプトは、UTF-8エンコーディングに標準で対応しているため、パラメータに日本語のタイプ名などを含める場合でも、通常は文字化けの問題は発生しません。
-   **既存のタイプ名**: すでにモデル内に存在する名前を `newName` に指定すると、コマンドはエラーを返します。




