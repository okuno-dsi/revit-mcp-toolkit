# 天井高さの確認と変更手順書

## 1. 概要
このドキュメントでは、Revitモデル内の天井要素の現在の高さを確認し、必要に応じてその高さを変更する手順を説明します。

**【重要: IDの取り扱いについて】**
Revit要素の識別には、`Element ID`（整数値）と`Unique ID`（GUID文字列）の2種類があります。可能な限り`Unique ID`の使用を優先してください。

## 2. 天井高さの確認

### ステップ1: 天井要素のIDを取得
`get_ceilings` コマンドで、モデル内の天井要素のリストを取得します。

**実行コマンド:**
```bash
python Python/Scripts/Reference/send_revit_command_durable.py --port 5210 --command get_ceilings
```

**実行結果例:**
```json
{
  "ok": true,
  "totalCount": 1,
  "ceilings": [
    {
      "elementId": 666,
      "typeId": 501,
      "levelId": 101,
      "area": 10.0
    }
  ]
}
```
この結果から、情報を確認したい天井の `elementId` または `uniqueId` を控えます。

### ステップ2: 天井のパラメータを取得
`get_ceiling_parameters` コマンドで、特定の天井のパラメータを取得し、「オフセット(基準レベル)」の値を確認します。

**実行コマンド:**
```bash
python Python/Scripts/Reference/send_revit_command_durable.py --port 5210 --command get_ceiling_parameters --params "{\"elementId\": 666}"
```

**実行結果例:**
```json
{
  "ok": true,
  "parameters": [
    {
      "name": "オフセット(基準レベル)",
      "storage": "Double",
      "value": "3000"
    },
    {
      "name": "コメント",
      "storage": "String",
      "value": "New ceiling"
    }
  ]
}
```
`"name": "オフセット(基準レベル)"` の `value` が現在の天井の高さです。

## 3. 天井高さの変更

`set_ceiling_parameter` コマンドを使用して、天井の高さを変更します。

**実行コマンド:**
```bash
python Python/Scripts/Reference/send_revit_command_durable.py --port 5210 --command set_ceiling_parameter --params "{\"elementId\": 666, \"paramName\": \"オフセット(基準レベル)\", \"value\": 3200.0}"
```

**パラメータ:**
-   `elementId` or `uniqueId`: 高さを変更したい天井のID。
-   `paramName`: 変更するパラメータ名。天井の高さは通常「オフセット(基準レベル)」です。
-   `value`: 設定したい新しい高さ（mm単位）。

**実行結果:**
コマンドが成功すると、`"ok": true` が返されます。再度 `get_ceiling_parameters` を実行して、値が変更されたことを確認できます。

## 4. 注意事項
-   `elementId` はRevitモデル内で一意のIDです。正しい天井要素のIDを指定してください。
-   `オフセット(基準レベル)` の値はミリメートル単位で指定します。
-   天井の高さ変更はRevitモデルに直接影響を与えます。変更前にモデルのバックアップを取ることを推奨します。



