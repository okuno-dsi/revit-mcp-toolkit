# Revit 構造要素配置手順書

この手順書は、RevitのMCPサーバーを通じて構造柱と構造フレーム（梁）を配置する方法を説明します。

**【重要: IDの取り扱いについて】**
Revit要素の識別には、`Element ID`（整数値）と`Unique ID`（GUID文字列）の2種類があります。`Unique ID`はプロジェクト間で一意であり、より堅牢な識別子として推奨されます。Revit MCPアドインは、`Unique ID`が提供された場合、自動的に対応する`Element ID`に変換して処理する機能を備えています。可能な限り`Unique ID`の使用を優先してください。

## 前提条件

*   Revitが起動しており、MCPアドインがロードされていること。
*   Python環境がセットアップされており、`requests` ライブラリがインストールされていること。
*   `Manuals/Scripts/send_revit_command_durable.py` スクリプトが利用可能であること。
*   ポート5211のRevitインスタンスを「構造」Revitとして使用します。

## 1. 必要な情報の取得

構造要素を配置する前に、利用可能なタイプ、レベル、グリッドの情報を取得します。これらのコマンドは、`Element ID`と`Unique ID`の両方を返します。**`Unique ID`の使用を推奨します。**

### 1.1. 構造柱タイプの一覧取得

```bash
python Python/Manuals/Scripts/send_revit_command_durable.py --port 5211 --command get_structural_column_types
```

### 1.2. 構造フレームタイプ（梁）の一覧取得

```bash
python Python/Manuals/Scripts/send_revit_command_durable.py --port 5211 --command get_structural_frame_types
```

### 1.3. グリッド情報の一覧取得

```bash
python Python/Manuals/Scripts/send_revit_command_durable.py --port 5211 --command get_grids
```

### 1.4. レベル情報の一覧取得

```bash
python Python/Manuals/Scripts/send_revit_command_durable.py --port 5211 --command get_levels
```

## 2. 構造柱の配置 (1FL)

`SSC標準 RC角柱 2` (typeId: 4982833) を1FL (levelId: 3150442, elevation: 200.0) のグリッド交点に配置します。

*   **X1, Y1 交点 (0.0, 0.0, 200.0)**
    ```bash
    python Python/Manuals/Scripts/send_revit_command_durable.py --port 5211 --command create_structural_column --params "{\"location\":{\"x\":0.0,\"y\":0.0,\"z\":200.0},\"levelId\":3150442,\"typeId\":4982833}"
    ```
*   **X2, Y1 交点 (10000.0, 0.0, 200.0)**
    ```bash
    python Python/Manuals/Scripts/send_revit_command_durable.py --port 5211 --command create_structural_column --params "{\"location\":{\"x\":10000.0,\"y\":0.0,\"z\":200.0},\"levelId\":3150442,\"typeId\":4982833}"
    ```
*   **X1, Y2 交点 (0.0, 10000.0, 200.0)**
    ```bash
    python Python/Manuals/Scripts/send_revit_command_durable.py --port 5211 --command create_structural_column --params "{\"location\":{\"x\":0.0,\"y\":10000.0,\"z\":200.0},\"levelId\":3150442,\"typeId\":4982833}"
    ```
*   **X2, Y2 交点 (10000.0, 10000.0, 200.0)**
    ```bash
    python Python/Manuals/Scripts/send_revit_command_durable.py --port 5211 --command create_structural_column --params "{\"location\":{\"x\":10000.0,\"y\":10000.0,\"z\":200.0},\"levelId\":3150442,\"typeId\":4982833}"
    ```

## 3. RC梁の配置 (1FL)

`SSC標準 RC梁` (typeId: 4974429, uniqueId: "type-unique-id-rc-beam") を1FL (levelId: 3150442, uniqueId: "level-unique-id-1fl", elevation: 200.0) の柱間に配置します。**`Unique ID`の使用を推奨します。**

*   **X1-X2 間 (Y1線上)**
    ```bash
    python Python/Manuals/Scripts/send_revit_command_durable.py --port 5211 --command create_structural_frame --params "{\"start\":{\"x\":0.0,\"y\":0.0,\"z\":200.0},\"end\":{\"x\":10000.0,\"y\":0.0,\"z\":200.0},\"levelId\":3150442,\"typeId\":4974429}"
    ```
    または
    ```bash
    python Python/Manuals/Scripts/send_revit_command_durable.py --port 5211 --command create_structural_frame --params "{\"start\":{\"x\":0.0,\"y\":0.0,\"z\":200.0},\"end\":{\"x\":10000.0,\"y\":0.0,\"z\":200.0},\"levelUniqueId\":\"level-unique-id-1fl\",\"typeUniqueId\":\"type-unique-id-rc-beam\"}"
    ```
*   **X1-X2 間 (Y2線上)**
    ```bash
    python Python/Manuals/Scripts/send_revit_command_durable.py --port 5211 --command create_structural_frame --params "{\"start\":{\"x\":0.0,\"y\":10000.0,\"z\":200.0},\"end\":{\"x\":10000.0,\"y\":10000.0,\"z\":200.0},\"levelId\":3150442,\"typeId\":4974429}"
    ```
    または
    ```bash
    python Python/Manuals/Scripts/send_revit_command_durable.py --port 5211 --command create_structural_frame --params "{\"start\":{\"x\":0.0,\"y\":10000.0,\"z\":200.0},\"end\":{\"x\":10000.0,\"y\":10000.0,\"z\":200.0},\"levelUniqueId\":\"level-unique-id-1fl\",\"typeUniqueId\":\"type-unique-id-rc-beam\"}"
    ```
*   **Y1-Y2 間 (X1線上)**
    ```bash
    python Python/Manuals/Scripts/send_revit_command_durable.py --port 5211 --command create_structural_frame --params "{\"start\":{\"x\":0.0,\"y\":0.0,\"z\":200.0},\"end\":{\"x\":0.0,\"y\":10000.0,\"z\":200.0},\"levelId\":3150442,\"typeId\":4974429}"
    ```
    または
    ```bash
    python Python/Manuals/Scripts/send_revit_command_durable.py --port 5211 --command create_structural_frame --params "{\"start\":{\"x\":0.0,\"y\":0.0,\"z\":200.0},\"end\":{\"x\":0.0,\"y\":10000.0,\"z\":200.0},\"levelUniqueId\":\"level-unique-id-1fl\",\"typeUniqueId\":\"type-unique-id-rc-beam\"}"
    ```
*   **Y1-Y2 間 (X2線上)**
    ```bash
    python Python/Manuals/Scripts/send_revit_command_durable.py --port 5211 --command create_structural_frame --params "{\"start\":{\"x\":10000.0,\"y\":0.0,\"z\":200.0},\"end\":{\"x\":10000.0,\"y\":10000.0,\"z\":200.0},\"levelId\":3150442,\"typeId\":4974429}"
    ```
    または
    ```bash
    python Python/Manuals/Scripts/send_revit_command_durable.py --port 5211 --command create_structural_frame --params "{\"start\":{\"x\":10000.0,\"y\":0.0,\"z\":200.0},\"end\":{\"x\":10000.0,\"y\":10000.0,\"z\":200.0},\"levelUniqueId\":\"level-unique-id-1fl\",\"typeUniqueId\":\"type-unique-id-rc-beam\"}"
    ```


## 4. RC梁の配置 (2FL)

`SSC標準 RC梁` (typeId: 4974429) を2FL (levelId: 5922012, elevation: 4200.0) の柱間に配置します。
この操作は `Python\create_2fl_beams.py` スクリプトでまとめて実行できます。

```bash
python Python/create_2fl_beams.py
```

## 5. 重複部材の削除

誤って重複して配置された部材がある場合、以下のコマンドで削除できます。
削除する部材の `elementId` を指定してください。

*   **RC梁 (ID: 5922050) の削除**
    ```bash
    python Python/Manuals/Scripts/send_revit_command_durable.py --port 5211 --command delete_structural_frame --params "{\"elementId\":5922050}"
    ```
*   **RC梁 (ID: 5922098) の削除**
    ```bash
    python Python/Manuals/Scripts/send_revit_command_durable.py --port 5211 --command delete_structural_frame --params "{\"elementId\":5922098}"
    ```

