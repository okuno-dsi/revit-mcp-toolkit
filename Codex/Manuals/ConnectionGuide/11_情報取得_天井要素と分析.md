# 天井要素情報の取得と分析手順書

## 1. 概要
このドキュメントでは、Revitモデル内の天井要素の情報を取得し、その高さや平面位置を分析する手順を説明します。

## 2. 関連コマンド
この分析には、複数のコマンドを段階的に使用します。

-   `get_ceilings`: モデル内のすべての天井要素の基本情報（IDリスト）を取得します。
-   `get_ceiling_parameters`: 特定の天井要素の全パラメータ（高さ情報など）を取得します。
-   `get_bounding_box`: 特定の天井要素の3次元的な境界（バウンディングボックス）を取得し、平面位置を特定します。

## 3. 実行手順

### ステップ1: 全ての天井IDを取得
まず、`get_ceilings`コマンドで、分析対象となる天井のIDをすべて取得します。

**実行コマンド:**
```bash
python Python/Manuals/Scripts/send_revit_command_durable.py --port 5210 --command get_ceilings
```
**実行結果例:**
```json
{
  "ok": true,
  "totalCount": 1,
  "ceilings": [
    {
      "elementId": 666,
      "typeId": 501,
      "levelId": 101,
      "area": 10.0
    }
  ]
}
```
この結果から、分析したい天井の `elementId` または `uniqueId` を控えます。

### ステップ2: 詳細情報の取得（パラメータとバウンディングボックス）
次に、ステップ1で控えたIDを使い、個別の天井の詳細情報を取得します。

**A. パラメータ（高さなど）の取得:**
`get_ceiling_parameters`コマンドで、天井の高さ（オフセット）などを確認します。

**実行コマンド:**
```bash
python Python/Manuals/Scripts/send_revit_command_durable.py --port 5210 --command get_ceiling_parameters --params "{"elementId": 666}"
```

**B. 平面位置（バウンディングボックス）の取得:**
`get_bounding_box`コマンドで、天井の正確な位置と広がりを確認します。

**実行コマンド:**
```bash
# パラメータはリスト形式である点に注意
python Python/Manuals/Scripts/send_revit_command_durable.py --port 5210 --command get_bounding_box --params "{"elementIds": [666]}"
```
**実行結果例:**
```json
{
  "ok": true,
  "min": {"x": 0, "y": 0, "z": 2700},
  "max": {"x": 4000, "y": 2000, "z": 2781.5}
}
```

## 4. 分析のポイント
-   **天井の高さ**: `get_ceiling_parameters`で取得した「オフセット(基準レベル)」パラメータの値で確認します。
-   **天井の平面位置**: `get_bounding_box`で取得した`min`と`max`のX, Y座標が、天井の平面的な範囲を示します。この情報を部屋の境界と比較することで、どの部屋に属する天井かを正確に判断できます。
